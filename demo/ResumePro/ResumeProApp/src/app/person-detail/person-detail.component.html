<div class="card">
  <div *ngIf="loading" class="loading">
    <p-progressSpinner></p-progressSpinner>
  </div>
  
  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
  </div>
  
  <div *ngIf="person && !loading" class="person-details">
    <h2>{{ person.firstName }} {{ person.lastName }}</h2>
    
    <p-tabView>
      <p-tabPanel header="Personal Information">
        <div class="grid">
          <div class="col-12 md:col-6">
            <div class="field">
              <label>Email</label>
              <div>{{ person.email }}</div>
            </div>
            
            <div class="field">
              <label>Phone</label>
              <div>{{ person.phoneNumber }}</div>
            </div>
            
            <div class="field">
              <label>Location</label>
              <div>{{ person.city }}, {{ person.state }}, {{ person.country }}</div>
            </div>
          </div>
          
          <div class="col-12 md:col-6">
            <div class="field">
              <label>LinkedIn</label>
              <div>{{ person.linkedIn }}</div>
            </div>
            
            <div class="field">
              <label>GitHub</label>
              <div>{{ person.gitHub }}</div>
            </div>
          </div>
        </div>
      </p-tabPanel>
      
      <p-tabPanel header="Resumes ({{ resumes.length }})">
        <p-table [value]="resumes" [tableStyle]="{'min-width': '50rem'}">
          <ng-template pTemplate="header">
            <tr>
              <th>ID</th>
              <th>Job Title</th>
              <th>Description</th>
              <th>Skills</th>
              <th>Actions</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-resume>
            <tr>
              <td>{{ resume.id }}</td>
              <td>{{ resume.jobTitle }}</td>
              <td>{{ resume.description }}</td>
              <td>{{ resume.skillCount }}</td>
              <td>
                <button pButton icon="pi pi-eye" class="p-button-rounded p-button-info" 
                        [routerLink]="['/people', personId, 'resume', resume.id]"></button>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
      
      <p-tabPanel header="Skills ({{ person.skillCount }})">
        <div *ngIf="person.skills && person.skills.length > 0">
          <p-chip *ngFor="let skill of person.skills" 
                  [label]="skill.title" 
                  styleClass="m-1"></p-chip>
        </div>
        <div *ngIf="!person.skills || person.skills.length === 0">
          No skills found.
        </div>
      </p-tabPanel>
      <p-tabPanel header="Education">
        <div *ngIf="person.schools && person.schools.length > 0">
          <div *ngFor="let school of person.schools" class="mb-3 p-3 border-round surface-card">
            <h3>{{ school.name }}</h3>
            <p>{{ school.location }}</p>
            <p>{{ school.startDate | date:'MMM yyyy' }} - {{ school.endDate ? (school.endDate | date:'MMM yyyy') : 'Present' }}</p>
            
            <div *ngIf="school.degrees && school.degrees.length > 0" class="mt-2">
              <h4>Degrees</h4>
              <ul>
                <li *ngFor="let degree of school.degrees">{{ degree.name }}</li>
              </ul>
            </div>
          </div>
        </div>
        <div *ngIf="!person.schools || person.schools.length === 0">
          No education information found.
        </div>
      </p-tabPanel>

      <p-tabPanel header="Languages" *ngIf="person.languages">
        <div *ngIf="person.languages && person.languages.length > 0">
          <div *ngFor="let language of person.languages" class="mb-3 p-3 border-round surface-card">
            <div class="flex justify-content-between align-items-center">
              <h3>{{ language.name }}</h3>
              <p-tag [severity]="getLanguageProficiencySeverity(language.proficiency)" 
                     [value]="language.proficiencyName"></p-tag>
            </div>
          </div>
        </div>
        <div *ngIf="!person.languages || person.languages.length === 0">
          No language information found.
        </div>
      </p-tabPanel>
    </p-tabView>
  </div>
</div>
